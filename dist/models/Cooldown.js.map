{"version":3,"sources":["../../src/models/Cooldown.js"],"names":["Schema","CooldownSchema","usage","type","String","unique","required","sec","Number","updatedAt","Date","default","now","CooldownClass","findOne","cooldown","is","format","findOneAndUpdate","$set","then","Error","__dirname","loadClass","Cooldown","model"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;;;AACA,IAAMA,SAAS,mBAASA,MAAxB;;AAEA,IAAMC,iBAAiB,IAAID,MAAJ,CAAW;AACjCE,QAAO,EAAEC,MAAMC,MAAR,EAAgBC,QAAQ,IAAxB,EAA8BC,UAAU,IAAxC,EAD0B;AAEjCC,MAAK,EAAEJ,MAAMK,MAAR,EAAgBF,UAAU,IAA1B,EAF4B;AAGjCG,YAAW,EAAEN,MAAMO,IAAR,EAAcC,SAASD,KAAKE,GAA5B;AAHsB,CAAX,CAAvB;;IAMMC,a;;;;;;;;uFACmBX,K;;;;;;;;eAEC,KAAKY,OAAL,CAAa,EAAEZ,OAAOA,KAAT,EAAb,C;;;AAAjBa,gB;AACAC,U,GAAK,wBAASC,MAAT,CAAgB,GAAhB,IAAuB,sBAAOF,SAASN,SAAhB,EAA2BQ,MAA3B,CAAkC,GAAlC,CAAvB,GAAgEF,SAASR,G;;aACjFS,E;;;;;;eAAiB,KAAKE,gBAAL,CAAsB,EAAEhB,OAAOA,KAAT,EAAtB,EAAwC,EAAEiB,MAAM,EAAEV,WAAW,uBAAb,EAAR,EAAxC,EAA2EW,IAA3E,CAAgF;AAAA,gBAAM,IAAN;AAAA,SAAhF,C;;;;;;yCACb,K;;;;;cAED,IAAIC,KAAJ,CAAUC,YAAY,IAAZ,cAAV,C;;;;;;;;;;;;;;;;;;;;;AAKTrB,eAAesB,SAAf,CAAyBV,aAAzB;;AAGA,IAAMW,WAAW,mBAASC,KAAT,CAAe,UAAf,EAA2BxB,cAA3B,CAAjB;;kBAEeuB,Q","file":"Cooldown.js","sourcesContent":["import mongoose from 'mongoose';\nimport moment from 'moment';\nconst Schema = mongoose.Schema;\n\nconst CooldownSchema = new Schema({\n\tusage: { type: String, unique: true, required: true },\n\tsec: { type: Number, required: true },\n\tupdatedAt: { type: Date, default: Date.now }\n});\n\nclass CooldownClass {\n\tstatic async isActivate(usage){\n\t\ttry {\n\t\t\tconst cooldown = await this.findOne({ usage: usage });\n\t\t\tconst is = moment().format('X') - moment(cooldown.updatedAt).format('X') > cooldown.sec;\n\t\t\tif(is) return await this.findOneAndUpdate({ usage: usage }, { $set: { updatedAt: moment() } }).then(() => true);\n\t\t\treturn false;\n\t\t} catch (e) {\n\t\t\tthrow new Error(__dirname + '\\n' + e);\n\t\t}\n\t}\n}\n\nCooldownSchema.loadClass(CooldownClass);\n\n\nconst Cooldown = mongoose.model('Cooldown', CooldownSchema);\n\nexport default Cooldown;"]}